{% extends "global/base.html" %}
{% load crispy_forms_tags %}

{% block content %}
    <style>
    /* CSS para simular o efeito deslizante/transição */
    .secao-animada {
        background-color: #f7f7f7;
        border: 1px solid #ddd;
        padding: 20px;
        margin-top: 15px;
        border-radius: 5px;
        /* Transição suave de altura para simular o "deslizante" */
        transition: max-height 0.8s ease-in-out, opacity 0.8s ease-in-out;
        opacity: 0;
        max-height: 0;
        overflow: hidden;
    }

    .secao-ativa {
        opacity: 1;
        max-height: 500px; /* Valor grande o suficiente para o conteúdo */
    }

    .mensagem-erro {
        color: red;
        font-weight: bold;
        margin-top: 10px;
    }
    .mensagem-aviso {
        color: orange;
        margin-top: 10px;
    }
</style>

<h1>Processamento de Sequência </h1>

{% if erro_mensagem %}
    <p class="mensagem-erro">{{ erro_mensagem }}</p>
{% endif %}


{% if etapa == 1 %}
    <div id="etapa-1">
        <h3>1. Inserir o Tamanho da Sequência (N)</h3>
        <form method="post" action="{% url 'sistemahorista:receber_array ' %}">
            {% csrf_token %}
            <label for="tamanho_sequencia">Tamanho N (obrigatório):</label>
            <input type="number" id="tamanho_sequencia" name="tamanho_sequencia" required min="1">
            <button type="submit">Próxima Etapa</button>
        </form>
    </div>
{% endif %}


{% if etapa == 2 %}
    <div id="etapa-2" class="secao-animada secao-ativa">
        <h3>2. Inserir Valores (Tamanho Alvo: **{{ tamanho_alvo }}**)</h3>

        <p>
            Digite todos os valores, separados por vírgula.
            Apenas os **primeiros {{ tamanho_alvo }}** serão processados.
        </p>

        <form method="post" action="{% url 'sistemahorista:receber_array ' %}"  >
            {% csrf_token %}
            <label for="valores_da_sequencia">Valores da Sequência:</label>
            <input type="text" id="valores_da_sequencia" name="valores_da_sequencia" placeholder="Ex: 10, 5, 20, 8, 30, 45" required>
            <button type="submit">Processar Sequência</button>
        </form>

        <br>
        <a href="{% url 'sistemahorista:receber_array ' %}">
            <button type="button">Reiniciar (Voltar ao Tamanho)</button>
        </a>
    </div>
{% endif %}


{% if etapa == 3 %}
    <div id="etapa-3" class="secao-animada secao-ativa">
        <h3>✅ Resultados Finais</h3>

        {% if aviso %}
            <p class="mensagem-aviso">**Aviso:** {{ aviso }}</p>
        {% endif %}

        <p><strong>Tamanho Processado:</strong> {{ tamanho_final }}</p>
        <p><strong>Sequência Processada:</strong> {{ resultado_sequencia|join:", " }}</p>
        <p><strong>Menor Valor (Mínimo):</strong> {{ menor_valor }}</p>
        <p><strong>Maior Valor (Máximo):</strong> {{ maior_valor }}</p>

        <br>
        <a href="{% url 'sistemahorista:receber_array ' %}">
            <button type="button">Novo Cálculo</button>
        </a>
    </div>
{% endif %}
{% endblock %}